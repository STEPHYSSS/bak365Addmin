webpackJsonp([9],{"+ThO":function(e,t,a){"use strict";var n={props:{page:{type:Object,default:function(){return{current_page:1,per_page:15,total:0}}}},methods:{handleCurrentChange:function(e){this.$emit("change_page",e)}}},r={render:function(){var e=this.$createElement;return(this._self._c||e)("el-pagination",{attrs:{"current-page":this.page.current_page,"page-size":this.page.per_page,layout:"total, prev, pager, next, jumper",total:this.page.total},on:{"current-change":this.handleCurrentChange}})},staticRenderFns:[]};var o=a("VU/8")(n,r,!1,function(e){a("KlkX")},null,null);t.a=o.exports},"1mza":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a("Xxa5"),r=a.n(n),o=a("exGp"),l=a.n(o),s=a("Ua8o"),i=a("mvu0"),c=a("+ThO"),u=a("woOf"),d=a.n(u),p=a("vhW1"),v=a("b6ye"),h=a("T+sA"),f={name:"receivingRecords",props:{currentRoute:Boolean},components:{cardNames:p.a,Pagination:c.a,couponNames:v.a},data:function(){return{loading:!0,daterange:"",search:{},page:{total:100,current_page:1},stateList:[{label:"",value:"全部"},{label:"0",value:"已删除"},{label:"1",value:"已领取"},{label:"2",value:"已激活"}],tableData:[]}},created:function(){var e=this;return l()(r.a.mark(function t(){return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.get_list();case 2:case"end":return t.stop()}},t,e)}))()},methods:{get_list:function(){var e=this;return l()(r.a.mark(function t(){var a,n;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.loading=!0,t.prev=1,a={},d()(a,e.search),d()(a,{Action:"GetSendList"}),t.next=7,Object(h.a)(a,"WeChatCardOpera");case 7:n=t.sent,e.tableData=n.Data.CardSendList||[],e.loading=!1,t.next=15;break;case 12:t.prev=12,t.t0=t.catch(1),e.loading=!1;case 15:case"end":return t.stop()}},t,e,[[1,12]])}))()},searchFun:function(){var e=this;return l()(r.a.mark(function t(){return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.daterange?(e.search.StartTime=e.daterange[0],e.search.EndTime=e.daterange[1]):(e.search.StartTime="",e.search.EndTime=""),t.next=3,e.get_list();case 3:case"end":return t.stop()}},t,e)}))()},changeValue:function(e){this.search.WeChatNo=e}},filters:{setStateFil:function(e){switch(Number(e)){case 0:return"已删除";case 1:return"已领取";case 2:return"已激活"}}},watch:{loading:function(e){this.$emit("setNoClick",e)}}},m={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"recordsStyle"},[a("el-row",[a("el-col",{attrs:{span:12}},[a("span",[e._v("激活时间：")]),e._v(" "),a("el-date-picker",{attrs:{type:"daterange","value-format":"yyyy-MM-dd HH:mm:ss","default-time":["00:00:00","23:59:59"],"range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:e.daterange,callback:function(t){e.daterange=t},expression:"daterange"}})],1),e._v(" "),e.currentRoute?e._e():a("el-col",{attrs:{span:12}},[a("span",{staticStyle:{display:"inline-block",width:"90px"}},[e._v("微信卡模板：")]),e._v(" "),a("cardNames",{attrs:{clearable:!0},on:{changeValue:e.changeValue}})],1),e._v(" "),e.currentRoute?a("el-col",{attrs:{span:12}},[a("span",{staticStyle:{display:"inline-block",width:"70px"}},[e._v("劵名称：")]),e._v(" "),a("couponNames")],1):e._e(),e._v(" "),a("el-col",{attrs:{span:12}},[a("div",{staticStyle:{width:"70px",display:"inline-block","text-align":"right"}},[e._v("状态：")]),e._v(" "),a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.search.State,callback:function(t){e.$set(e.search,"State",t)},expression:"search.State"}},e._l(e.stateList,function(e){return a("el-option",{key:e.label,attrs:{label:e.value,value:e.label}})}),1)],1)],1),e._v(" "),a("el-button",{staticStyle:{"margin-left":"75px"},attrs:{type:"primary"},on:{click:e.searchFun}},[e._v("筛选")]),e._v(" "),a("el-button",{attrs:{type:"primary"}},[e._v("下载")]),e._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData}},[e.currentRoute?e._e():a("el-table-column",{attrs:{prop:"Name",label:"卡模板名称"}}),e._v(" "),e.currentRoute?a("el-table-column",{attrs:{prop:"date",label:"优惠券名称"}}):e._e(),e._v(" "),e.currentRoute?e._e():a("el-table-column",{attrs:{label:"绑定卡号"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.CardNo?a("span",[e._v(e._s(t.row.CardNo))]):a("span",[e._v("--")])]}}],null,!1,864707669)}),e._v(" "),e.currentRoute?a("el-table-column",{attrs:{prop:"name",label:"优惠券码"}}):e._e(),e._v(" "),a("el-table-column",{attrs:{label:"状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(e._f("setStateFil")(t.row.State)))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"AddTime",label:"领取时间"}}),e._v(" "),e.currentRoute?e._e():a("el-table-column",{attrs:{prop:"ActivateTime",label:"激活时间"}}),e._v(" "),e.currentRoute?a("el-table-column",{attrs:{prop:"address",label:"使用时间"}}):e._e()],1)],1)},staticRenderFns:[]};var b=a("VU/8")(f,m,!1,function(e){a("QZLK")},null,null).exports,g=a("sMN7"),_=(a("2uFj"),{name:"vipList",components:{Del:i.a,Pagination:c.a,ReceivingRecords:b},data:function(){return{activeName:"first",show:!1,disabled:!0,current_index:"",current_weChatNo:"",page:{total:100,current_page:1},dialogVisible:!1,stateVal:"",tableData:[],loading:!1,loadingTable:!0,loadingImg:!1,QRCodeImg:""}},created:function(){var e=this;return l()(r.a.mark(function t(){return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return g.a.get("activeName")&&(e.activeName=g.a.get("activeName")),t.next=3,e.getList();case 3:case"end":return t.stop()}},t,e)}))()},computed:{currentRoute:function(){return"/wechatCard/Coupon/list"===this.$route.path||!1}},methods:{getList:function(){var e=this;return l()(r.a.mark(function t(){var a;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e.loadingTable=!0,e.disabled=!0,t.next=5,Object(h.a)({Action:"GetTemplateList"},"WeChatCardOpera");case 5:a=t.sent,e.tableData=a.Data.TemplateList,e.tableData.forEach(function(e){1===Number(e.Start)?e.Start=!0:e.Start=!1}),e.loadingTable=!1,e.disabled=!1,t.next=17;break;case 12:t.prev=12,t.t0=t.catch(0),e.loadingTable=!1,e.$message.error(t.t0),e.disabled=!1;case 17:case"end":return t.stop()}},t,e,[[0,12]])}))()},handleClick:function(){g.a.set("activeName",this.activeName)},changeEnable:function(e,t){var a=this;return l()(r.a.mark(function n(){var o,l;return r.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return o=!0===e?"1":"0",n.prev=1,n.next=4,Object(h.a)({Action:"SetCardStart",SID:t.SID,Start:o},"WeChatCardOpera");case 4:l=n.sent,a.$message.success(l.Message),n.next=12;break;case 8:n.prev=8,n.t0=n.catch(1),setTimeout(function(){t.Start=!t.Start},500),a.$message.error(n.t0);case 12:case"end":return n.stop()}},n,a,[[1,8]])}))()},showPopover:function(e){var t=this;return l()(r.a.mark(function a(){var n;return r.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,t.loadingImg=!0,a.next=4,Object(h.a)({Action:"GetQrCode",WeChatNo:e.WeChatNo},"WeChatCardOpera");case 4:n=a.sent,t.QRCodeImg="../"+n.Message,t.loadingImg=!1,a.next=13;break;case 9:a.prev=9,a.t0=a.catch(0),t.loadingImg=!1,t.$message.error(a.t0);case 13:case"end":return a.stop()}},a,t,[[0,9]])}))()},upDownUrl:function(){Object(s.a)(this.QRCodeImg)},inspectState:function(e){var t=this;return l()(r.a.mark(function a(){return r.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return t.dialogVisible=!0,t.loading=!0,a.prev=2,a.next=5,Object(h.a)({Action:"GetCard",WeChatNo:e.WeChatNo},"WeChatCardOpera");case 5:t.loading=!1,t.stateVal="通过审核",t.getList(),a.next=15;break;case 10:a.prev=10,a.t0=a.catch(2),t.loading=!1,t.stateVal="待审核",t.$message.error(a.t0);case 15:case"end":return a.stop()}},a,t,[[2,10]])}))()},copyUrl:function(e){if(e.url){var t=$(".el-popover").length-1;$($(".el-popover")[t]).find("input").select(),document.execCommand("Copy"),this.$Message.info("复制成功")}else this.$Message.info("复制失败");e.visibleUrl=!1},editRow:function(e){this.$router.push({path:"/wechatCard/vip/newlyBuild",query:{id:e.SID}})},delRow:function(e,t){this.show=!0,this.current_index=t,this.current_weChatNo=e.WeChatNo},delFunction:function(e){this.show=e},confirmEnd:function(){var e=this;return l()(r.a.mark(function t(){return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Object(h.a)({Action:"RemoveCard",WeChatNo:e.current_weChatNo},"WeChatCardOpera");case 3:e.show=!1,e.$message.success("删除成功"),e.tableData.splice(e.current_index,1),t.next=12;break;case 8:t.prev=8,t.t0=t.catch(0),e.show=!1,e.$message.error(t.t0);case 12:case"end":return t.stop()}},t,e,[[0,8]])}))()},get_list:function(e){},addNewCard:function(){this.currentRoute?this.$router.push("/wechatCard/Coupon/newlyBuild"):this.$router.push("/wechatCard/vip/newlyBuild")},setNoClick:function(e){this.disabled=e}},filters:{isAudit:function(e){switch(Number(e)){case 1:return"通过审核";case 0:return"待审核"}}},watch:{}}),w={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"vipListType"},[a("el-tabs",{attrs:{type:"card"},on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{disabled:e.disabled,label:e.currentRoute?"优惠劵管理":"微信卡模板",name:"first"}},[a("el-button",{staticStyle:{"margin-bottom":"15px"},attrs:{type:"primary"},on:{click:e.addNewCard}},[e._v(e._s(e.currentRoute?"新建优惠劵":"新建微信卡模板")+"\n        ")]),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loadingTable,expression:"loadingTable"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,size:"medium"}},[e.currentRoute?e._e():a("el-table-column",{attrs:{prop:"VipTitle",label:"微卡模板名"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.Name?[e._v(e._s(t.row.Name))]:[e._v("--")]]}}],null,!1,2554274005)}),e._v(" "),e.currentRoute?a("el-table-column",{attrs:{prop:"name",label:"优惠券名称"}}):e._e(),e._v(" "),e.currentRoute?e._e():a("el-table-column",{attrs:{label:"状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n              "+e._s(e._f("isAudit")(t.row.Audit))+"\n            ")]}}],null,!1,2143827262)}),e._v(" "),e.currentRoute?a("el-table-column",{attrs:{prop:"state",label:"优惠券状态"}}):e._e(),e._v(" "),a("el-table-column",{attrs:{prop:"GetQuantity",label:"领取数量"}}),e._v(" "),a("el-table-column",{attrs:{label:"创建时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.AddTime?[e._v(e._s(t.row.AddTime))]:[e._v("--")]]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"是否启用"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-checkbox",{on:{change:function(a){return e.changeEnable(a,t.row)}},model:{value:t.row.Start,callback:function(a){e.$set(t.row,"Start",a)},expression:"scoped.row.Start"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{width:"300",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{staticStyle:{"margin-right":"10px"},attrs:{type:"text"},on:{click:function(a){return e.inspectState(t.row)}}},[e._v("\n                检查"+e._s(e.currentRoute?"券":"卡")+"状态\n              ")]),e._v(" "),e.currentRoute?a("el-popover",{attrs:{placement:"left"},model:{value:t.row.visibleUrl,callback:function(a){e.$set(t.row,"visibleUrl",a)},expression:"scoped.row.visibleUrl"}},[a("el-input",{attrs:{readonly:"",placeholder:"请输入内容"},model:{value:t.row.url,callback:function(a){e.$set(t.row,"url",a)},expression:"scoped.row.url"}},[a("el-button",{attrs:{slot:"append"},on:{click:function(a){return e.copyUrl(t.row)}},slot:"append"},[e._v("复制")])],1),e._v(" "),a("el-button",{staticStyle:{"margin-right":"10px"},attrs:{slot:"reference",type:"text"},slot:"reference"},[e._v("链接")])],1):e._e(),e._v(" "),a("el-popover",{attrs:{placement:"left"},on:{show:function(a){return e.showPopover(t.row)}},model:{value:t.row.visible,callback:function(a){e.$set(t.row,"visible",a)},expression:"scoped.row.visible"}},[a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loadingImg,expression:"loadingImg"}],staticClass:"smallRoutine"},[a("div",{staticClass:"smallRoutineTop"},[a("span",[e._v("二维码")]),e._v(" "),a("span",{staticClass:"close",on:{click:function(e){t.row.visible=!1}}},[e._v("×")])]),e._v(" "),a("div",{staticStyle:{width:"200px",height:"200px",border:"1px solid #efefef"}},[a("img",{staticStyle:{width:"100%",height:"100%"},attrs:{src:e.QRCodeImg,alt:""}})]),e._v(" "),a("a",{staticClass:"smallRoutineUpDown",attrs:{disabled:!e.QRCodeImg},on:{click:e.upDownUrl}},[e._v("下载二维码")]),e._v(" "),a("span")]),e._v(" "),a("el-button",{staticStyle:{"margin-right":"8px"},attrs:{slot:"reference",type:"text"},slot:"reference"},[e._v("二维码")])],1),e._v(" "),a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.editRow(t.row)}}},[e._v("编辑")]),e._v(" "),a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.delRow(t.row,t.$index)}}},[e._v("删除")])]}}])})],1),e._v(" "),a("Del",{attrs:{show:e.show},on:{delFunction:e.delFunction,confirmEnd:e.confirmEnd}})],1),e._v(" "),a("el-tab-pane",{attrs:{disabled:e.disabled,label:"领取记录",name:"second"}},[a("ReceivingRecords",{ref:"Records",attrs:{currentRoute:e.currentRoute},on:{setNoClick:e.setNoClick}})],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"提示",visible:e.dialogVisible,width:"400px"},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("span",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}]},[e._v(e._s(e.stateVal))]),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.dialogVisible=!1}}},[e._v("确 定")])],1)])],1)},staticRenderFns:[]};var x=a("VU/8")(_,w,!1,function(e){a("ZdDS")},null,null);t.default=x.exports},KlkX:function(e,t){},QZLK:function(e,t){},ZdDS:function(e,t){}});
//# sourceMappingURL=9.8bcdaa4be686cfede174.js.map
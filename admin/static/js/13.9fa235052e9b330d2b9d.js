webpackJsonp([13],{G9x7:function(e,t,r){"use strict";var a=r("Xxa5"),o=r.n(a),i=r("exGp"),l=r.n(i),s=r("T+sA"),n={props:{showTicket:{type:Boolean,default:!1}},data:function(){return{dialogVisible:!1,tiketList:[],multipleSelection:[],tiketName:""}},created:function(){},methods:{getTicket:function(){var e=this;return l()(o.a.mark(function t(){var r;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Object(s.a)({Action:"GetTicketList",TypeName:e.tiketName},"MProdOpera");case 3:r=t.sent,e.tiketList=r.TicketList,console.log(e.tiketList),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),e.$message.error(t.t0);case 11:case"end":return t.stop()}},t,e,[[0,8]])}))()},handleSelectionChange:function(e){this.multipleSelection=e},confirmEnd:function(){this.$emit("confirmTicket"),this.dialogVisible=!1},searchName:function(){this.getTicket()}},watch:{showTicket:function(e){this.dialogVisible=e},dialogVisible:function(e){this.$emit("changeDigTicket",e)}}},c={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-dialog",{staticClass:"dialogTicketFa",attrs:{title:"选择电子券",visible:e.dialogVisible,width:"600px"},on:{"update:visible":function(t){e.dialogVisible=t}}},[r("span",[e._v("名称搜索")]),e._v(" "),r("el-input",{staticStyle:{"margin-right":"10px",width:"180px"},attrs:{placeholder:"请输入"},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.searchName(t)}},model:{value:e.tiketName,callback:function(t){e.tiketName=t},expression:"tiketName"}}),e._v(" "),r("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.tiketList,"tooltip-effect":"dark"},on:{"selection-change":e.handleSelectionChange}},[r("el-table-column",{attrs:{type:"selection",width:"55",align:"center"}}),e._v(" "),r("el-table-column",{attrs:{prop:"TypeNo",label:"编号",align:"center"}}),e._v(" "),r("el-table-column",{attrs:{prop:"TypeName",label:"名称",align:"center"}}),e._v(" "),r("el-table-column",{attrs:{prop:"Price",label:"售价",align:"center"}}),e._v(" "),r("el-table-column",{attrs:{prop:"TakeMoney",label:"面额",align:"center"}}),e._v(" "),r("el-table-column",{attrs:{prop:"TakeDisc",label:"折扣",align:"center"}})],1),e._v(" "),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:e.confirmEnd}},[e._v("确 定")])],1)],1)},staticRenderFns:[]};var u=r("VU/8")(n,c,!1,function(e){r("OBtO")},null,null);t.a=u.exports},OBtO:function(e,t){},gyMa:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r("woOf"),o=r.n(a),i=r("Xxa5"),l=r.n(i),s=r("exGp"),n=r.n(s),c=r("ysSL"),u=r("nkvz"),m=r("7Zmj"),p=r("BBpc"),f=r("3ZIU"),d=r("Cn51"),b=r("G9x7"),g=r("Ua8o"),v=r("u4Bf"),y=r.n(v),h=r("T+sA"),k=r("M4fF"),F=r.n(k),T=(r("G9QH"),r("QvYb")),_={name:"addTiket",data:function(){return{loading:!1,FeaturesShow:!0,ImportantNotesShow:!0,isCoverCurrentImgs:!1,fileListUpList:[],fileListUpMain:[],goodsShow:!1,dialogVisible:!1,stockTypeList:[{label:"不使用库存",value:"0"},{label:"使用商城库存",value:"1"}],assistRuleForm:{BuyTimeBool:!1},ruleForm:{PayType:["1","2"],ProdType:"1"},rules:{ProdNo:[T.d(this)],ProdNoChildren:[T.e(this)],NameChildren:[T.c(this)],Name:[T.b(this)],StoreQty:[T.g(this)],CateSID:[T.a(this)],Describe:[{required:!0,message:"请输入商品描述",trigger:"blur"}],SalePrice:[{required:!0,message:"请输入商品售价",trigger:"blur"}]},tiketList:[],tiketName:""}},created:function(){this.tiketInfo(),this.$route.query.SID||this.getTicket()},methods:{tiketInfo:function(){var e=this;return n()(l.a.mark(function t(){var r,a,o,i;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.$route.query.SID){t.next=24;break}return t.prev=1,t.next=4,Object(h.a)({Action:"GetProdInfo",SID:e.$route.query.SID,ProdType:"1"},"MProdOpera");case 4:r=t.sent,a=r.Data,e.ruleForm=a.ProdInfo,e.ruleForm.CateSID=e.ruleForm.CateSID?e.ruleForm.CateSID.split(","):e.ruleForm.CateSID,e.$refs.goodType.value=e.ruleForm.CateSID,e.ruleForm.PayType=e.ruleForm.PayType?e.ruleForm.PayType.split(","):[],e.ruleForm.BuyTime&&(e.assistRuleForm.BuyTimeBool=!0,e.ruleForm.BuyTime=e.ruleForm.BuyTime?e.ruleForm.BuyTime.split(","):[]),e.fileListUpList=e.ruleForm.ImgList?Object(g.d)(e.ruleForm.ImgList):[],e.fileListUpMain=e.ruleForm.Img?Object(g.d)(e.ruleForm.Img):[],o=$.base64.atob(e.ruleForm.Features,"utf8"),i=$.base64.atob(e.ruleForm.ImportantNotes,"utf8"),o=o.replace(/src="Files/g,'src="../Files'),i=i.replace(/src="Files/g,'src="../Files'),e.$refs.Features.setUEContent(o),e.$refs.ImportantNotes.setUEContent(i),t.next=24;break;case 21:t.prev=21,t.t0=t.catch(1),e.$message.error(t.t0);case 24:case"end":return t.stop()}},t,e,[[1,21]])}))()},changeGoodType:function(e){this.ruleForm.CateSID=e},clickTicket:function(){this.dialogVisible=!0},getTicket:function(){var e=this;return n()(l.a.mark(function t(){var r,a;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Object(h.a)({Action:"GetTicketList",TypeName:e.tiketName},"MProdOpera");case 3:r=t.sent,a=r.Data,e.tiketList=a.TicketList,t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),e.$message.error(t.t0);case 11:case"end":return t.stop()}},t,e,[[0,8]])}))()},handleCurrentChange:function(e){this.ruleForm.ProdNo=e.TypeNo,this.ruleForm.Name=e.TypeName},confirmEnd:function(){this.dialogVisible=!1},changeDigTicket:function(e){this.showTicket=e},changeTasteList:function(e,t){0===t?this.ruleForm.Tag=e:3===t&&(this.ruleForm.AccessoriesInfo=e)},upLoadImgsList:function(e){var t=[];e.forEach(function(e){t.push(e.url)}),this.ruleForm.ImgList=t.join(",")},upLoadImgsMain:function(e){this.fileListUp=e,e.length>0?this.ruleForm.Img=e[0].url:this.ruleForm.Img=""},preserveFun:function(){var e,t=this;this.$refs.ruleForm.validate((e=n()(l.a.mark(function e(r){var a,i,s;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r){e.next=4;break}return e.abrupt("return",!1);case 4:if(e.prev=4,a=F.a.cloneDeep(t.ruleForm),o()(a,{Action:"SetProdInfo"}),a.CateSID="string"!=typeof a.CateSID&&a.CateSID?a.CateSID.join(","):a.CateSID,a.PayType="string"!=typeof a.PayType&&a.PayType?a.PayType.join(","):a.PayType,a.AccessoriesInfo="string"!=typeof a.AccessoriesInfo&&a.AccessoriesInfo?a.AccessoriesInfo.join(","):a.AccessoriesInfo,i=t.$refs.Features.getUEContent(),s=t.$refs.ImportantNotes.getUEContent(),i=i.replace(/src="\.\.\/Files/g,'src="Files'),s=s.replace(/src="\.\.\/Files/g,'src="Files'),a.Features=$.base64.btoa(i,"utf8"),a.ImportantNotes=$.base64.btoa(s,"utf8"),!t.assistRuleForm.BuyTimeBool){e.next=23;break}if(a.BuyTime){e.next=20;break}return t.$message.info("填写购买时间"),e.abrupt("return");case 20:a.BuyTime=a.BuyTime.join(","),e.next=24;break;case 23:a.BuyTime="";case 24:if(a.Img){e.next=29;break}return t.$message.info("请添加主商品图片"),e.abrupt("return");case 29:a.Img=Object(g.f)(a,"Img");case 30:if(a.ImgList){e.next=35;break}return t.$message.info("请添加商品图片"),e.abrupt("return");case 35:a.ImgList=Object(g.f)(a,"ImgList");case 36:return a.FinHour>0&&(a.FinHour="1"===t.isAdvanceTime?24*a.FinHour:a.FinHour),e.next=39,Object(h.a)(a,"MProdOpera");case 39:t.$router.push("/weChat/manager/goodSetting"),t.$message.success("操作成功"),e.next=46;break;case 43:e.prev=43,e.t0=e.catch(4),t.$message.error(e.t0);case 46:case"end":return e.stop()}},e,t,[[4,43]])})),function(t){return e.apply(this,arguments)}))},cancelFun:function(){}},components:{goodType:c.a,imgLoad:u.a,Goods:m.a,Tree:p.a,ueditor1:d.a,TicketInfo:b.a,vuedraggable:y.a,tasteList:f.a}},x={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"addEditGoods"},[e._v("\n  基本信息\n  "),r("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"150px"}},[r("el-form-item",{attrs:{label:"类别",prop:"CateSID"}},[r("goodType",{ref:"goodType",on:{changeGoodType:e.changeGoodType}})],1),e._v(" "),r("el-form-item",{attrs:{label:"电子券类型编号"}},[r("el-input",{attrs:{readonly:"",placeholder:"请选择电子券"},model:{value:e.ruleForm.ProdNo,callback:function(t){e.$set(e.ruleForm,"ProdNo",t)},expression:"ruleForm.ProdNo"}}),e._v(" "),e.$route.query.SID?e._e():r("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary",size:"medium"},on:{click:e.clickTicket}},[e._v("...")])],1),e._v(" "),r("el-form-item",{attrs:{label:"电子券名称",prop:"Name"}},[r("el-input",{attrs:{placeholder:"请填写商品名称"},model:{value:e.ruleForm.Name,callback:function(t){e.$set(e.ruleForm,"Name",t)},expression:"ruleForm.Name"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"面值",prop:"SalePrice"}},[r("el-input-number",{attrs:{"controls-position":"right",min:0},model:{value:e.ruleForm.SalePrice,callback:function(t){e.$set(e.ruleForm,"SalePrice",t)},expression:"ruleForm.SalePrice"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"商品描述",prop:"Describe"}},[r("el-input",{attrs:{type:"textarea",rows:3,placeholder:"最长支持200个字符",maxlength:"200"},model:{value:e.ruleForm.Describe,callback:function(t){e.$set(e.ruleForm,"Describe",t)},expression:"ruleForm.Describe"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"主商品图片"}},[r("imgLoad",{attrs:{folder:"ProdImg",isAutoFixed:!0,fileListUp:e.fileListUpMain,limit:1},on:{upLoadImgs:e.upLoadImgsMain}}),e._v("(建议尺寸:800*800;大小:小于2M;格式:JPG,PNG,JPEG)\n    ")],1),e._v(" "),r("el-form-item",{attrs:{label:"商品图片",prop:"ImgList"}},[r("imgLoad",{attrs:{folder:"ProdImg",isAutoFixed:!0,fileListUp:e.fileListUpList},on:{upLoadImgs:e.upLoadImgsList}}),e._v("(建议尺寸:800*800;大小:小于2M;格式:JPG,PNG,JPEG)\n    ")],1),e._v(" "),r("el-form-item",{attrs:{label:"商品排序",prop:"Sort"}},[r("el-input-number",{attrs:{"controls-position":"right",min:1,step:1,"step-strictly":""},model:{value:e.ruleForm.Sort,callback:function(t){e.$set(e.ruleForm,"Sort",t)},expression:"ruleForm.Sort"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"商品库存"}},[r("el-input-number",{attrs:{"controls-position":"right",min:0,step:1,"step-strictly":""},model:{value:e.ruleForm.StoreQty,callback:function(t){e.$set(e.ruleForm,"StoreQty",t)},expression:"ruleForm.StoreQty"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"库存类型"}},[r("el-select",{attrs:{placeholder:"请选择"},model:{value:e.ruleForm.StockType,callback:function(t){e.$set(e.ruleForm,"StockType",t)},expression:"ruleForm.StockType"}},e._l(e.stockTypeList,function(e){return r("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),r("el-form-item",{attrs:{label:"每人限购",prop:"MaxBuyCnt"}},[r("el-input-number",{attrs:{"controls-position":"right",min:0},model:{value:e.ruleForm.MaxBuyCnt,callback:function(t){e.$set(e.ruleForm,"MaxBuyCnt",t)},expression:"ruleForm.MaxBuyCnt"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"销量基数",prop:"SaleCnt"}},[r("el-input-number",{attrs:{"controls-position":"right",min:0,step:1,"step-strictly":""},model:{value:e.ruleForm.SaleCnt,callback:function(t){e.$set(e.ruleForm,"SaleCnt",t)},expression:"ruleForm.SaleCnt"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"商品标签",prop:"Tag"}},[r("tasteList",{ref:"labelRef",attrs:{multiple:!1,Type:0,allowCreate:!1},on:{changeTaste:function(t){return e.changeTasteList(t,0)}}})],1),e._v(" "),r("el-form-item",{attrs:{label:"支付方式",prop:"PayType"}},[r("el-checkbox-group",{model:{value:e.ruleForm.PayType,callback:function(t){e.$set(e.ruleForm,"PayType",t)},expression:"ruleForm.PayType"}},[r("el-checkbox",{attrs:{label:"2"}},[e._v("微信支付")]),e._v(" "),r("el-checkbox",{attrs:{label:"1"}},[e._v("微卡支付")])],1)],1),e._v(" "),r("el-form-item",{attrs:{label:"可购买时间",prop:"BuyTime"}},[r("el-checkbox",{model:{value:e.assistRuleForm.BuyTimeBool,callback:function(t){e.$set(e.assistRuleForm,"BuyTimeBool",t)},expression:"assistRuleForm.BuyTimeBool"}},[e._v("启用")]),e._v("  \n      "),r("el-time-picker",{attrs:{"is-range":"","value-format":"HH:mm:ss","range-separator":"至","start-placeholder":"开始时间","end-placeholder":"结束时间",placeholder:"选择时间范围"},model:{value:e.ruleForm.BuyTime,callback:function(t){e.$set(e.ruleForm,"BuyTime",t)},expression:"ruleForm.BuyTime"}})],1),e._v(" "),r("el-form-item",{staticClass:"FeaturesStyle",attrs:{label:"产品特色",prop:"Features"}},[!1===e.FeaturesShow?r("el-button",{attrs:{type:"text"},on:{click:function(t){e.FeaturesShow=!0}}},[e._v("+编辑")]):e._e(),e._v(" "),e.FeaturesShow?r("ueditor1",{ref:"Features"}):e._e(),e._v(" "),!0===e.FeaturesShow?r("el-button",{attrs:{type:"text"},on:{click:function(t){e.FeaturesShow=!1}}},[e._v("隐藏")]):e._e()],1),e._v(" "),r("el-form-item",{staticClass:"FeaturesStyle",attrs:{label:"重要提示",prop:"ImportantNotes"}},[!1===e.ImportantNotesShow?r("el-button",{attrs:{type:"text"},on:{click:function(t){e.ImportantNotesShow=!0}}},[e._v("+编辑")]):e._e(),e._v(" "),e.ImportantNotesShow?r("ueditor1",{ref:"ImportantNotes"}):e._e(),e._v(" "),!0===e.ImportantNotesShow?r("el-button",{attrs:{type:"text"},on:{click:function(t){e.ImportantNotesShow=!1}}},[e._v("隐藏")]):e._e()],1)],1),e._v(" "),r("el-dialog",{staticClass:"dialogTicketFa",attrs:{title:"选择电子券",visible:e.dialogVisible,width:"600px"},on:{"update:visible":function(t){e.dialogVisible=t}}},[r("span",[e._v("名称搜索")]),e._v(" "),r("el-input",{staticStyle:{"margin-right":"10px",width:"180px"},attrs:{placeholder:"请输入"},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.searchName(t)}},model:{value:e.tiketName,callback:function(t){e.tiketName=t},expression:"tiketName"}}),e._v(" "),r("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.tiketList,"highlight-current-row":""},on:{"current-change":e.handleCurrentChange}},[r("el-table-column",{attrs:{prop:"TypeNo",label:"编号",align:"center"}}),e._v(" "),r("el-table-column",{attrs:{prop:"TypeName",label:"名称",align:"center"}}),e._v(" "),r("el-table-column",{attrs:{prop:"Price",label:"售价",align:"center"}}),e._v(" "),r("el-table-column",{attrs:{prop:"TakeMoney",label:"面额",align:"center"}}),e._v(" "),r("el-table-column",{attrs:{prop:"TakeDisc",label:"折扣",align:"center"}})],1),e._v(" "),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:e.confirmEnd}},[e._v("确 定")])],1)],1),e._v(" "),r("div",{staticClass:"preserveStyle"},[r("el-button",{on:{click:e.cancelFun}},[e._v("取消")]),e._v(" "),r("el-button",{staticStyle:{"margin-left":"20px"},attrs:{type:"primary"},on:{click:e.preserveFun}},[e._v("保存")])],1)],1)},staticRenderFns:[]};var S=r("VU/8")(_,x,!1,function(e){r("znBM")},"data-v-83d373b6",null);t.default=S.exports},znBM:function(e,t){}});
//# sourceMappingURL=13.9fa235052e9b330d2b9d.js.map
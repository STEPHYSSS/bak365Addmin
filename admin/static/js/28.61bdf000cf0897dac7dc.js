webpackJsonp([28],{gsdW:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("mvHQ"),i=n.n(r),s=n("woOf"),a=n.n(s),l=n("Xxa5"),o=n.n(l),u=n("exGp"),c=n.n(u),d=n("T+sA"),m=n("M4fF"),p=n.n(m),v=n("Ua8o"),h={name:"menuBar",data:function(){return{loading:!0,loadingBtn:!1,currentMouse:!1,currentIndex:"",currentMouseChild:"",currentIndexChild:"",navigationList:[{name:"商品分类",url:"https://fanyi.baidu.com",type:"view",sub_button:[]},{name:"商品分1",url:"",type:"",sub_button:[{name:"商品类型1",url:"https://fanyi.baidu.com",type:"view"}]}],popoverWidth:90,optionsList:[{name:"关键字",id:"click"},{name:"链接地址",id:"view"}],ruleForm:{},rules:{name:[{required:!0,message:"请输入",trigger:"blur"}],urlCilck:[{required:!0,trigger:"blur",validator:function(t,e,n){Object(v.g)(e,128,n,"请填写","请输入不超过128个英文和64个汉字",!1)}}],url:[{required:!0,trigger:"blur",validator:function(t,e,n){Object(v.g)(e,1024,n,"请填写链接","请输入不超过1024个英文和512个汉字",!1)}}],type:[{required:!0,message:"请选择",trigger:"change"}]}}},created:function(){var t=this;return c()(o.a.mark(function e(){var n,r,i,s,a,l;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t.loading=!0,e.next=4,Object(d.a)({Action:"GetMenu"},"MBaseOpera");case 4:for(n=e.sent,t.navigationList=n.Data.MenuInfo.CustomText,r=t.navigationList,i=0;i<r.length;i++){for(s=r[i],a=0;a<s.length;i++)(l=s[a]).url?l.disabled=!0:l.disabled=!1;s.url?s.disabled=!0:s.disabled=!1}t.loading=!1,e.next=16;break;case 11:e.prev=11,e.t0=e.catch(0),t.loading=!1,t.navigationList=[],t.$message.error("string"==typeof e.t0?e.t0:"信息获取失败");case 16:t.ruleForm={arr:t.navigationList};case 17:case"end":return e.stop()}},e,t,[[0,11]])}))()},mounted:function(){},updated:function(){},methods:{mouseoverPa:function(t){this.currentMouse=!0,this.currentIndex=t},mouseoverChild:function(t){this.currentMouseChild=!0,this.currentIndexChild=t},clickDelChild:function(t,e){this.navigationList[t].sub_button.splice(e,1)},clickDel:function(t){this.navigationList.splice(t,1)},showPopover:function(){this.popoverWidth=this.$refs.navigationLi[0].offsetWidth},changeType:function(t){t.url="",t.disabled=!1,this.$refs.ruleForm.clearValidate()},AddList:function(){this.navigationList.length<3?this.navigationList.push({name:"店铺主页",url:"",type:"view",sub_button:[]}):this.$message.info("一级导航最多添加3条")},AddListChild:function(t){t.length<5?t.push({name:"店铺主页",url:"",type:"view"}):this.$message.info("二级导航最多添加5条")},submitForm:function(){var t,e=this;this.$refs.ruleForm.validate((t=c()(o.a.mark(function t(n){var r,s,l;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!n){t.next=21;break}return t.prev=1,e.loadingBtn=!0,r={},a()(r,{Action:"SetMenu"}),(s=p.a.clone(e.ruleForm.arr)).forEach(function(t){t.sub_button.length>0&&(delete t.url,delete t.type)}),l=i()(s),a()(r,{CustomText:l}),t.next=11,Object(d.a)(r,"MBaseOpera");case 11:e.$message.success("操作成功"),e.loadingBtn=!1,t.next=19;break;case 15:t.prev=15,t.t0=t.catch(1),e.loadingBtn=!1,e.$message.error("string"==typeof t.t0?t.t0:"添加失败");case 19:t.next=22;break;case 21:return t.abrupt("return",!1);case 22:case"end":return t.stop()}},t,e,[[1,15]])})),function(e){return t.apply(this,arguments)}))},handleCommand:function(t,e){"customUrl"===t?e.url&&!e.disabled||(e.url="",e.disabled=!1):(e.url=t,e.disabled=!0)}}},f={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"menuBar"},[t._m(0),t._v(" "),n("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}]},[n("div",{staticClass:"menuBarLeft"},[n("div",{staticClass:"menuBarLeftTop"}),t._v(" "),n("div",{staticClass:"menuBarLeftCenter"},[n("div",{staticClass:"CenterTop"}),t._v(" "),n("div",{staticClass:"CenterBottom"},[n("div",{class:{CenterBottomLeft:!0,borderRight:0===t.navigationList.length}}),t._v(" "),n("ul",{staticClass:"CenterBottomRight"},t._l(t.navigationList,function(e){return n("li",{ref:"navigationLi",refInFor:!0,staticClass:"popoverStyle",style:{width:100/t.navigationList.length+"%",float:"left"}},[e.sub_button.length>0?n("el-popover",{attrs:{placement:"top",width:t.popoverWidth,trigger:"click"},on:{show:t.showPopover}},[n("ul",{staticClass:"popoverLi"},t._l(e.sub_button,function(e){return n("li",[t._v("\n                      "+t._s(e.name)+"\n                    ")])}),0),t._v(" "),n("span",{attrs:{slot:"reference"},slot:"reference"},[t._v(t._s(e.name))])]):n("span",{style:{width:100/t.navigationList.length+"%"}},[t._v("\n                      "+t._s(e.name)+"\n                    ")])],1)}),0)])]),t._v(" "),n("div",{staticClass:"menuBarLeftBottom"})]),t._v(" "),n("div",{staticClass:"menuBarRight"},[n("el-form",{ref:"ruleForm",attrs:{model:t.ruleForm,rules:t.rules,"label-width":"90px"}},[t._l(t.ruleForm.arr,function(e,r){return t.ruleForm.arr.length>0?n("div",{key:r,staticClass:"menuBarOne",on:{mouseover:function(e){return t.mouseoverPa(r)},mouseout:function(e){t.currentMouse=!1}}},[n("div",{staticClass:"menuBarRightH1"},[t._v("一级导航")]),t._v(" "),n("div",{staticClass:"menuBarRightOne",staticStyle:{padding:"0 35px"}},[n("el-form-item",{staticClass:"Keyword",attrs:{label:"入口名称",prop:"arr."+r+".name",rules:t.rules.name}},[n("el-input",{attrs:{maxlength:"4","show-word-limit":""},model:{value:e.name,callback:function(n){t.$set(e,"name",n)},expression:"item.name"}})],1),t._v(" "),!e.sub_button.length>0?n("el-form-item",{staticClass:"changeType",attrs:{prop:"arr."+r+".type",rules:t.rules.type}},[n("el-select",{attrs:{placeholder:"请选择"},on:{change:function(n){return t.changeType(e)}},model:{value:e.type,callback:function(n){t.$set(e,"type",n)},expression:"item.type"}},t._l(t.optionsList,function(t){return n("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}),1)],1):t._e(),t._v(" "),!e.sub_button.length>0&&"click"===e.type?n("el-form-item",{staticStyle:{"margin-bottom":"20px"},attrs:{label:"关键字",prop:"arr."+r+".url",rules:t.rules.urlCilck}},[n("el-input",{attrs:{maxlength:"128"},model:{value:e.url,callback:function(n){t.$set(e,"url",n)},expression:"item.url"}})],1):t._e(),t._v(" "),!e.sub_button.length>0&&"view"===e.type?n("el-form-item",{staticStyle:{"margin-bottom":"20px"},attrs:{label:"链接地址",prop:"arr."+r+".url",rules:t.rules.url}},[n("el-input",{attrs:{disabled:e.disabled,maxlength:"1024"},model:{value:e.url,callback:function(n){t.$set(e,"url",n)},expression:"item.url"}}),t._v(" "),n("el-dropdown",{on:{command:function(n){return t.handleCommand(n,e)}}},[n("span",{staticClass:"el-dropdown-link"},[t._v("\n                    修改链接地址\n                  ")]),t._v(" "),n("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[n("el-dropdown-item",{attrs:{command:"customUrl"}},[t._v("自定义链接")])],1)],1)],1):t._e(),t._v(" "),e.sub_button.length>0?n("span",{staticClass:"tipTitle"},[t._v("使用二级导航后主链接已失效")]):t._e()],1),t._v(" "),n("div",{staticClass:"menuBarRightTwo"},[n("h2",{staticClass:"menuBarRightH2"},[t._v("二级导航")]),t._v(" "),t._l(e.sub_button,function(i,s){return e.sub_button.length>0?n("div",{key:r,staticClass:"menuBarRightOne",on:{mouseover:function(e){return t.mouseoverChild(s)},mouseout:function(e){t.currentMouseChild=!1}}},[n("el-form-item",{staticClass:"Keyword",attrs:{label:"入口名称",prop:"arr."+r+".sub_button."+s+".name",rules:t.rules.name}},[n("el-input",{attrs:{maxlength:"7","show-word-limit":""},model:{value:i.name,callback:function(e){t.$set(i,"name",e)},expression:"itemChild.name"}})],1),t._v(" "),n("el-form-item",{staticClass:"changeType",attrs:{prop:"arr."+r+".sub_button."+s+".type",rules:t.rules.type}},[n("el-select",{attrs:{placeholder:"请选择"},model:{value:i.type,callback:function(e){t.$set(i,"type",e)},expression:"itemChild.type"}},t._l(t.optionsList,function(t){return n("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}),1)],1),t._v(" "),"click"===i.type?n("el-form-item",{staticStyle:{"margin-bottom":"20px"},attrs:{label:"关键字",prop:"arr."+r+".sub_button."+s+".url",rules:t.rules.url}},[n("el-input",{model:{value:i.url,callback:function(e){t.$set(i,"url",e)},expression:"itemChild.url"}})],1):t._e(),t._v(" "),"view"===i.type?n("el-form-item",{staticStyle:{"margin-bottom":"20px"},attrs:{label:"链接地址",prop:"arr."+r+".sub_button."+s+".url",rules:t.rules.url}},[n("el-input",{attrs:{disabled:i.disabled},model:{value:i.url,callback:function(e){t.$set(i,"url",e)},expression:"itemChild.url"}}),t._v(" "),n("el-dropdown",{on:{command:function(e){return t.handleCommand(e,i)}}},[n("span",{staticClass:"el-dropdown-link"},[t._v("\n                    修改链接地址\n                  ")]),t._v(" "),n("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[n("el-dropdown-item",{attrs:{command:"customUrl"}},[t._v("自定义链接")])],1)],1)],1):t._e(),t._v(" "),n("span",{directives:[{name:"show",rawName:"v-show",value:t.currentMouseChild&&s===t.currentIndexChild,expression:"currentMouseChild&&indexChild===currentIndexChild"}],staticClass:"el-icon-error delIcon",on:{click:function(e){return t.clickDelChild(r,s)}}})],1):t._e()}),t._v(" "),n("div",{staticClass:"AddList",on:{click:function(n){return t.AddListChild(e.sub_button)}}},[n("i",{staticClass:"el-icon-circle-plus"}),n("span",{staticStyle:{"margin-left":"8px"}},[t._v("添加二级导航")])])],2),t._v(" "),n("span",{directives:[{name:"show",rawName:"v-show",value:t.currentMouse&&r===t.currentIndex,expression:"currentMouse&&index===currentIndex"}],staticClass:"el-icon-error delIcon",on:{click:function(e){return t.clickDel(r)}}})]):t._e()}),t._v(" "),n("div",{staticClass:"AddList",on:{click:t.AddList}},[n("i",{staticClass:"el-icon-circle-plus"}),n("span",{staticStyle:{"margin-left":"8px"}},[t._v("添加一级导航")])])],2)],1),t._v(" "),n("div",{staticStyle:{"text-align":"center",margin:"20px 0",clear:"both"}},[n("el-button",{staticStyle:{"margin-top":"20px"},attrs:{type:"primary",loading:t.loadingBtn},on:{click:t.submitForm}},[t._v("提交")])],1)])])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"menuBarTip"},[e("h4",[this._v("微信菜单设置")]),this._v(" "),e("span",[this._v("由于微信接口延迟，菜单修改后最长可能需要30分钟才会更新。如需即时查看，可先取消关注，再重新关注。注意：一级导航最多设置三个，二级导航最多设置五个\n        ")])])}]};var g=n("VU/8")(h,f,!1,function(t){n("zjPz")},null,null);e.default=g.exports},zjPz:function(t,e){}});
//# sourceMappingURL=28.61bdf000cf0897dac7dc.js.map
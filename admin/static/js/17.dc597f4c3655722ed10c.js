webpackJsonp([17],{"LJ/4":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r("Xxa5"),s=r.n(o),a=r("woOf"),i=r.n(a),l=r("exGp"),n=r.n(l),u=r("b6ye"),m=r("nkvz"),c=r("Cn51"),p=r("T+sA"),F=(r("G9QH"),r("Ua8o")),f={name:"addEditCoupon",components:{couponList:u.a,imgLoad:m.a,ueditor1:c.a},data:function(){var e=this;return{btnLoading:!1,ruleForm:{PayType:"",Start:0},assistRuleForm:{BuyTime:[]},rules:{Name:[{required:!0,message:"商品名称未填",trigger:"blur",validator:function(t,r,o){e.ruleForm.Name?o():o(new Error("商品名称未填"))}}],StoreQty:[{required:!0,message:"请输入商品售价",trigger:"blur"}],SalePrice:[{required:!0,message:"请输入库存",trigger:"blur"}]},FeaturesShow:!0,ImportantNotesShow:!0,ueditorProduct:"",ueditorTip:"",currentCouponList:"",defaultId:null,fileListUp:[]}},created:function(){this.ruleForm={},this.$route.query.SID&&this.getInfo()},methods:{getInfo:function(){var e=this;return n()(s.a.mark(function t(){var r,o;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,r={},i()(r,{SID:e.$route.query.SID}),i()(r,{Action:"GetTicket"}),t.next=6,Object(p.a)(r,"MTicketOpera");case 6:o=t.sent,e.ruleForm=o.Data.Ticket,e.ueditorProduct=$.base64.atob(e.ruleForm.Features,"utf8"),e.ueditorTip=$.base64.atob(e.ruleForm.ImportantNotes,"utf8"),e.ruleForm.Start=Number(e.ruleForm.Start),e.ruleForm.BuyTime?(e.ruleForm.Start=!0,e.assistRuleForm.BuyTime=[e.ruleForm.BuyTime,e.ruleForm.EndTime]):e.ruleForm.Start=!1,e.defaultId=e.ruleForm.Type,e.fileListUp=e.ruleForm.ImgList?Object(F.d)(e.ruleForm.ImgList):[],t.next=18;break;case 16:t.prev=16,t.t0=t.catch(0);case 18:case"end":return t.stop()}},t,e,[[0,16]])}))()},changeValue:function(e){this.$set(this.ruleForm,"Type",e.TypeNo),this.currentCouponList=e},cancelFun:function(){this.$router.push("/weChat/manager/couponSetting")},resetForm:function(e){this.$refs[e].resetFields(),this.changeValue({}),this.$refs.couponList.value="",this.$refs.imgLoad.currentImgs=[],this.assistRuleForm.BuyTime=[],this.ruleForm.Start=!1,this.$refs.ImportantNotes.setUEContent(""),this.$refs.Features.setUEContent(""),this.ruleForm.ImgList=""},upLoadImgs:function(e){var t=[];e.forEach(function(e){t.push(e.url)}),this.ruleForm.ImgList=t.join(",")},preserveFun:function(){var e,t=this;(this.ruleForm.ImgList&&(this.ruleForm.ImgList=Object(F.f)(this.ruleForm,"ImgList")),this.ruleForm.Start&&0===this.assistRuleForm.BuyTime.length)?this.$message.info("请选择购买时间"):0!==this.ruleForm.ImgList.length?this.$refs.ruleForm.validate((e=n()(s.a.mark(function e(r){var o;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!r){e.next=22;break}return e.prev=1,o={},i()(o,{Action:"SetTicket"}),i()(o,t.ruleForm),t.ruleForm.Start?(o.Start=1,o.BuyTime=t.assistRuleForm.BuyTime[0],o.EndTime=t.assistRuleForm.BuyTime[1]):(o.Start=0,o.BuyTime="",o.EndTime=""),o.Features=$.base64.btoa(t.$refs.Features.getUEContent(),"utf8"),o.ImportantNotes=$.base64.btoa(t.$refs.ImportantNotes.getUEContent(),"utf8"),t.btnLoading=!0,e.next=11,Object(p.a)(o,"MTicketOpera");case 11:t.btnLoading=!1,t.$message.success("操作成功"),t.$router.push("/weChat/manager/couponSetting"),e.next=20;break;case 16:e.prev=16,e.t0=e.catch(1),t.btnLoading=!1,t.$message.error(e.t0);case 20:e.next=23;break;case 22:return e.abrupt("return",!1);case 23:case"end":return e.stop()}},e,t,[[1,16]])})),function(t){return e.apply(this,arguments)})):this.$message.info("请选择商品图片")}},watch:{"ruleForm.Type":function(){this.currentCouponList&&(this.$set(this.ruleForm,"Name",this.currentCouponList.TypeName),this.$set(this.ruleForm,"SalePrice",this.currentCouponList.Price))}}},d={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"addEditGoods"},[e._v("\n  基本信息\n  "),r("el-form",{ref:"ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"150px"}},[r("el-form-item",{attrs:{label:"券类型"}},[r("couponList",{ref:"couponList",attrs:{defaultId:e.defaultId},on:{changeValue:e.changeValue}})],1),e._v(" "),r("el-form-item",{attrs:{label:"商品名称",prop:"Name"}},[r("el-input",{attrs:{placeholder:"请填写商品名称"},model:{value:e.ruleForm.Name,callback:function(t){e.$set(e.ruleForm,"Name",t)},expression:"ruleForm.Name"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"商品售价",prop:"SalePrice"}},[r("el-input-number",{attrs:{"controls-position":"right",min:0,step:1,"step-strictly":""},model:{value:e.ruleForm.SalePrice,callback:function(t){e.$set(e.ruleForm,"SalePrice",t)},expression:"ruleForm.SalePrice"}}),e._v("\n      ¥\n    ")],1),e._v(" "),r("el-form-item",{attrs:{label:"库存",prop:"StoreQty"}},[r("el-input-number",{attrs:{"controls-position":"right",min:0,step:1,"step-strictly":""},model:{value:e.ruleForm.StoreQty,callback:function(t){e.$set(e.ruleForm,"StoreQty",t)},expression:"ruleForm.StoreQty"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"商品图片",prop:"ProdImgList"}},[r("imgLoad",{ref:"imgLoad",attrs:{folder:"TicketImg",fileListUp:e.fileListUp,isAutoFixed:!0},on:{upLoadImgs:e.upLoadImgs}}),e._v("\n      (建议尺寸:800*800;大小:小于500kb;格式:JPG,PNG,JPEG)\n    ")],1),e._v(" "),r("el-form-item",{attrs:{label:"商品排序",prop:"Sort"}},[r("el-input-number",{attrs:{"controls-position":"right",min:0,step:1,"step-strictly":""},model:{value:e.ruleForm.Sort,callback:function(t){e.$set(e.ruleForm,"Sort",t)},expression:"ruleForm.Sort"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"销量基数",prop:"SaleCnt"}},[r("el-input-number",{attrs:{"controls-position":"right",min:0,step:1,"step-strictly":""},model:{value:e.ruleForm.SaleCnt,callback:function(t){e.$set(e.ruleForm,"SaleCnt",t)},expression:"ruleForm.SaleCnt"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"预定提示",prop:"Tips"}},[r("el-input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:3},placeholder:"最长可输入500个字符",maxlength:"500"},model:{value:e.ruleForm.Tips,callback:function(t){e.$set(e.ruleForm,"Tips",t)},expression:"ruleForm.Tips"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"支付方式",prop:"PayType"}},[r("el-radio-group",{model:{value:e.ruleForm.PayType,callback:function(t){e.$set(e.ruleForm,"PayType",t)},expression:"ruleForm.PayType"}},[r("el-radio",{attrs:{label:"1"}},[e._v("不支持第三方支付")]),e._v(" "),r("el-radio",{attrs:{label:"2"}},[e._v("不支持微卡支付")])],1)],1),e._v(" "),r("el-form-item",{attrs:{label:"购买时间",prop:"Start"}},[r("el-checkbox",{model:{value:e.ruleForm.Start,callback:function(t){e.$set(e.ruleForm,"Start",t)},expression:"ruleForm.Start"}},[e._v("启用")]),e._v(" "),e.ruleForm.Start?r("el-date-picker",{attrs:{type:"datetimerange","value-format":"yyyy-MM-dd HH:mm:ss","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:e.assistRuleForm.BuyTime,callback:function(t){e.$set(e.assistRuleForm,"BuyTime",t)},expression:"assistRuleForm.BuyTime"}}):e._e()],1),e._v(" "),r("el-form-item",{attrs:{label:"每人限购",prop:"LimitCnt"}},[r("el-input-number",{attrs:{"controls-position":"right",min:1},model:{value:e.ruleForm.LimitCnt,callback:function(t){e.$set(e.ruleForm,"LimitCnt",t)},expression:"ruleForm.LimitCnt"}})],1),e._v(" "),r("el-form-item",{staticClass:"FeaturesStyle",attrs:{label:"产品特色"}},[!1===e.FeaturesShow?r("el-button",{attrs:{type:"text"},on:{click:function(t){e.FeaturesShow=!0}}},[e._v("+编辑")]):e._e(),e._v(" "),e.FeaturesShow?r("ueditor1",{ref:"Features",attrs:{valText:e.ueditorProduct}}):e._e(),e._v(" "),!0===e.FeaturesShow?r("el-button",{attrs:{type:"text"},on:{click:function(t){e.FeaturesShow=!1}}},[e._v("隐藏")]):e._e()],1),e._v(" "),r("el-form-item",{staticClass:"FeaturesStyle",attrs:{label:"重要提示"}},[!1===e.ImportantNotesShow?r("el-button",{attrs:{type:"text"},on:{click:function(t){e.ImportantNotesShow=!0}}},[e._v("+编辑")]):e._e(),e._v(" "),e.ImportantNotesShow?r("ueditor1",{ref:"ImportantNotes",attrs:{valText:e.ueditorTip}}):e._e(),e._v(" "),!0===e.ImportantNotesShow?r("el-button",{attrs:{type:"text"},on:{click:function(t){e.ImportantNotesShow=!1}}},[e._v("隐藏")]):e._e()],1)],1),e._v(" "),r("div",{staticClass:"preserveStyle"},[r("el-button",{on:{click:e.cancelFun}},[e._v("取消")]),e._v(" "),r("el-button",{staticStyle:{"margin-left":"20px"},on:{click:function(t){return e.resetForm("ruleForm")}}},[e._v("重置")]),e._v(" "),r("el-button",{staticStyle:{"margin-left":"20px"},attrs:{type:"primary",loading:e.btnLoading},on:{click:e.preserveFun}},[e._v("保存")])],1)],1)},staticRenderFns:[]};var h=r("VU/8")(f,d,!1,function(e){r("YYs6")},null,null);t.default=h.exports},YYs6:function(e,t){}});
//# sourceMappingURL=17.dc597f4c3655722ed10c.js.map